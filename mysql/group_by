
//Как работает group by на примере экселя
1. Запишите данные на лист
2. Отсортируйте по тем полям, которые должны быть в group by.
3. Читая отсортированные данные подряд в любом случае,
когда значение в очередной строке в колонках,
указанных в group by отличается от значений в предыдущей - вставьте новую строку
4. Скопируйте значения колонок group by
5. В остальные поместите формулы вроде СУММ() ячеек группы под которой подводится итог.

Результат group by - это именно эти вставленные итоговые записи.
СУБД работает примерно по такому же алгоритму - сначала сортирует,
потом суммирует идущие подряд одинаковые записи.
