
//////////////////////////////////////////////
//////////////////Загрузка ОС/////////////////
//////////////////////////////////////////////
//BIOS - Basic Input Output System
1. BIOS - загрузка платформонезависимого загрузчика Bootstrap,
встроенного в ПО BIOS
2. MBR - bootstrap идентифицирует на жестком диске MBR,
отдает управление загрузчику IPL1, который является частью MBR
3. Boot Loader - загрузчик IPL1 находит активный раздел,
находит его загрузочную запись, отдает управление IPL2
4. Kernel - загрузчик IPL2 ищет системные файлы в системном загрузчике
5. OS - системные файлы загружают операционную систему

//UEFI - Unified Extensible Firmware Interface
1. UEFI
2. EFI Boor Loader
3. Kernel
4. OS
 - ПО UEFI само может загружать системные файлы ОС
 - минус 2 служебные программки: IPL1 и IPL2.



//////////////////////////////////////////////
///////Логическая структура накопителя////////
//////////////////////////////////////////////

//Раздел жесткого диска (partition) - выделенный объем жесткого диска
Выды разделов:
- первичный (основной) раздел - логический диск,
обазательно должен дыть на физическом диске,
всегда содержить только одну ФС,
при использовании MBR может быит максимум 4 первичных раздела
- расширенный (дополнительный) раздела - часть диска,
на которой можно создать несколько логических дисков,
содержит другие логические разделы (неограниченное количество),
данные о каждом разделе хранятся в отдельной расширенной загрузочной записи (EBR),
не содержит собственную ФС.

//Логический диск или том (volume) - часть диска,
рассматриваемая как единое целое

//Файловая система - порядок, определяющий способ организации,
хранения и именования данных.



//Организация записей на носителе
LBA - Logical Block Address - логическая адресация сектором,
как будто они расположены в одну линеку



//////////////////////////////////////////////
/////////////Структкра диска MBR//////////////
//////////////////////////////////////////////
//LBA0 - MBR - код и данные, расположенные в первых физических секторах
Занимает 512 байт:
1. 446 байт - код загрузчтка IPL1 - Initial Program Loading
 - при загрузке находит активный раздел (один из 4-х)
 - в корневой папке активного раздела ОС сохраняет системные файлы,
управляющие загрузкой операционной системы (системный загрузчик)
2. 4*16 байт - таблица для 4-х разделов (partition table)
3. 2 байта - сигнатура (55h AAh) - проверочный код, с помощью которого
программное обеспечение, которое идентифицирует главную загрузочную запись,
ситает что главная загрузочная запись жива и цела.

MBR создается при создании структуры разделов



//////////////////////////////////////////////
/////////////////////GPT//////////////////////
//////////////////////////////////////////////
//GPT - Guid Partition Table
 - Другой формат представления разделов.
 - Очень большое количество разделов.
 - Нет необходимости в создании расширенного раздела.
 - При создании структуры GPT, сектор с адресом LAB0 называется PMBR
 - UEFI может поддерживать и MBR и GPT
 - Guid - глобальный универсальный идентификатор



//////////////////////////////////////////////
/////////////Структкра диска GPT//////////////
//////////////////////////////////////////////
//1. LBA0 - PMBR - Protected Master Boot Record
 - нет загрузчика - первые 446 байт нули,
либо старый загрузчик от MBR, который ничего не делает
 - Вместо 4 записей по 16 байт - 1 запись 16 байт,
со служебным кодом, который запрещает старым ОС,
не понимающим GPT, работать с этим диском
 - 3*16 байт нули
 - 2 байта сигнатура - для совместимости,
чтобы старая ОС считала это защищенным разделом
 - НЕТ СВЕДЕНИЙ О РАЗДЕЛАХ

//LBA1 - HEADER - служебная запись в следующем за PMBR секторе LBA1
 - оглавление таблицы разделов

//LBA2-LBA33 (31 сектор) - GPT
Тут хранится таблица разделов в формате GUID

//Последний сектор диска хранит копию HEADER

//Последний сектор - 32 сектора - копия GPT



//////////////////////////////////////////////
/////////////Типы разделов в GPT//////////////
//////////////////////////////////////////////
1. Раздел данных - то же что и основной раздел
2. Шифрованный EFI раздел
 - создается автоматически
 - является аналогом активного раздела в структуре MBR
 - т.е. в нем ОС хранит свои загрузчики,
свои системные файлы с расширением .efi
 - раздел скрыт - нельзя открыть средствами ОС
 - файловая система FAT для совместимости со всеми ОС
3. Раздел восстановления
 - создается автоматически
 - как правило 300 мб
 - содержит ПО для загрузки аварийной системы восстановления
4. MSR
 - создается автоматически
 - Microsoft Service Reserve - Резервный Раздел Майкрософт
 - как правило 128 мб
 - не форматируется
 - используется в windows, т.к. windows могут потребоваться
неотфорамтированный сектора, а UEFI и GPT не поддерживают
доступ к пустым секторам (вне раздела)



