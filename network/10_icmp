
ICMP - Internet Control Message Protocol

- протокол межсетевых управляющих сообщений
- нет гарантии доставки
- не обязательно должны обрабатываться



//Фомат заголовка ICMP
 - 1 байт - тип сообщения - что произошло с сети - САМОЕ ГЛАВНОЕ
 - 1 байт - код сообщения - более подробно тип ошибки, причина или диагностическое действие
 - 2 байта - контрольная сумма
 - 4 байта - служебная информация, зависит от типа и кода сообщения
 - поле данных



//2 вида ICMP сообщений
1. Запрос/Ответ
 - тип 0 и тип 8 - запрос и ответ
2. Сообщение без запроса
 - тип 3, тип 5



//Типы сообщений
 - 0 - эхо-ответ (проверка доступности пк)
 - 3 - узел назначение недостижим (сообщение об ошибке)
 - 5 - перенаправление маршрута (кот. позволяет быстрее попасть к необходимой сети)
 - 8 - эхо-запрос (проверка доступности пк)
 - 9 - сообщение о маршрутизаторе (маршрутизаторы рассылают инфу о себе автоматически)
 - 10 - запрос сообщения о маршрутизаторе (можно послать чтобы не дожидаться рассылки от маршрутизатора)
 - 11 - истечение времени жизни пакета (когда маршрутизатор отбросил пакет время жизни которого истекло (ПЕТЛЯ))
 - 12 - проблемы с параметрами (в заголове IP какая-то ошибка и маршрутизатор не может отправить такой пакет)
 - 13 - запрос отметки времени (проверка бустродействия сети)
 - 14 - ответ отметки времени (проверка бустродействия сети)



//Коды сообщений (для типа сообщения 3 - узел назначение недостижим)
 - 0 - сеть недостижима
 - 1 - узел недостижим
 - 2 - протокол недостижим
 - 3 - порт недостижим
 - 4 - ошибка фрагментации
 - 5 - ошибка в маршруте источника
 - 6 - сеть назначения неизвестна
 - 7 - узел назначения неизвестен
 - 8 - узел источник изолирован
 - 9 - административный запрет



//Утилиты
1. ping
2. traceroute
 - пк отправляет сообщение с ttl = 1
 - первый маршрутизатор уменьшает ttl на 1 и возвращает ответ пк
 - traceroute из заголовка ip-пакета, в которого вложен icmp извлекает ip-адрес маршрутизатора
 - отправляется сообщение с ttl = 2
 - и т.д.


